/*
	https://github.com/hi098123/Tistory_Comment
	License : MIT
	Version : 2020-05-06
*/
var hi098123_id,hi098123_id2,tistory_hi098123_comment=[],rps_finder=[],comment_refresh_num=0,Comment_option={link:!0,prevent_rp_del:!1,remove_report:!1,comment_urls:0,comment_urls_open:0,imgs:{enable:!1,whitelist:[],blacklist:[]}},comment_history={node:"",code:""};function rplc_(e,t,r){return e.split(t).join(r)}function hi098123_comment(e,t){comment_history={node:e,code:t};var r=document.createElement("div"),n=document.createElement("div"),_=document.createElement("div");r.innerHTML=t,n.innerHTML=r.querySelector("s_rp2_container").innerHTML,r.querySelector("s_rp2_container").innerHTML="";for(var o=0;o<tistory_hi098123_comment.length;o++){var i=r.innerHTML,m=tistory_hi098123_comment[tistory_hi098123_comment[o]];if(i=rplc_(i,"[#_rp_rep_id_#]",tistory_hi098123_comment[o]),i=rplc_(i,"[#_rp_rep_logo_#]",m.logo),i=rplc_(i,"[#_rp_rep_class_#]",m.cls),Comment_option.link)i=rplc_(i,"[#_rp_rep_name_#]",m.name);else(s=document.createElement("a")).innerHTML=m.name,i=rplc_(i,"[#_rp_rep_name_#]",s.innerText);if(i=Comment_option.remove_report?rplc_(i,"[#_rp_rep_date_#]",m.date.split("<")[0]):rplc_(i,"[#_rp_rep_date_#]",m.date),Comment_option.imgs.enable&&(m.comm=imgLoad_hi098123(m.comm,Comment_option.imgs.whitelist,Comment_option.imgs.blacklist)),isNaN(Comment_option.comment_urls))i=rplc_(i,"[#_rp_rep_desc_#]",urlfy(m.comm,Comment_option.comment_urls));else switch(Comment_option.comment_urls){case 1:i=rplc_(i,"[#_rp_rep_desc_#]",urlfy(m.comm,[TistoryBlog.url.split("/")[2],TistoryBlog.tistoryUrl.split("/")[2]]));break;case 2:i=rplc_(i,"[#_rp_rep_desc_#]",urlfy(m.comm,[]));break;case 0:default:i=rplc_(i,"[#_rp_rep_desc_#]",m.comm)}i=rplc_(i,"[#_rp_rep_onclick_delete_#]",(Comment_option.prevent_rp_del&&tistory_hi098123_comment[tistory_hi098123_comment[o]].rps.length?"S":"_")+m.delbtn),i=rplc_(i,"[#_rp_rep_onclick_reply_#]",m.repbtn);for(var c="",l=(m=tistory_hi098123_comment[tistory_hi098123_comment[o]].rps,0);l<m.length;l++){var p=n.innerHTML;if(p=rplc_(p,"[#_rp_rep_id_#]",m[l]),p=rplc_(p,"[#_rp_rep_logo_#]",m[m[l]].logo),p=rplc_(p,"[#_rp_rep_class_#]",m[m[l]].cls),Comment_option.link)p=rplc_(p,"[#_rp_rep_name_#]",m[m[l]].name);else{var s;(s=document.createElement("a")).innerHTML=m[m[l]].name;var a=s.getElementsByTagName("img")[0]||"";p=rplc_(p,"[#_rp_rep_name_#]",(a=""!=a?a.outerHTML:"")+" "+s.innerText)}if(p=Comment_option.remove_report?rplc_(p,"[#_rp_rep_date_#]",m[m[l]].date.split("<")[0]):rplc_(p,"[#_rp_rep_date_#]",m[m[l]].date),isNaN(Comment_option.comment_urls))p=rplc_(p,"[#_rp_rep_desc_#]",urlfy(m[m[l]].comm,Comment_option.comment_urls));else switch(Comment_option.comment_urls){case 1:p=rplc_(p,"[#_rp_rep_desc_#]",urlfy(m[m[l]].comm,[TistoryBlog.url.split("/")[2],TistoryBlog.tistoryUrl.split("/")[2]]));break;case 2:p=rplc_(p,"[#_rp_rep_desc_#]",urlfy(m[m[l]].comm,[]));break;case 0:default:p=rplc_(p,"[#_rp_rep_desc_#]",m[m[l]].comm)}p=rplc_(p,"[#_rp_rep_onclick_delete_#]",(Comment_option.prevent_rp_del&&l<m.length-1?"S":"_")+m[m[l]].delbtn),p=rplc_(p,"<s_rp2_rep>",""),c+=p=rplc_(p,"</s_rp2_rep>","")}_.innerHTML+=i,_.querySelector("s_rp2_container").outerHTML=c}_.innerHTML=rplc_(_.innerHTML,"<s_rp_rep>",""),_.innerHTML=rplc_(_.innerHTML,"</s_rp_rep>","");var d=document.querySelector(".tt_more_preview_comments_wrap")||"";""!=d&&(-1==d.getAttribute("onclick").indexOf("_getEntryCommentsByPaging")&&d.setAttribute("onclick",rplc_(d.getAttribute("onclick"),"getEntryCommentsByPaging","_getEntryCommentsByPaging")),d=d.outerHTML),document.querySelector(e).innerHTML=d+_.innerHTML,hi098123_id=void 0,hi098123_id2=void 0}function SdeleteComment(){alert(decodeURIComponent(escape(atob("64u16riA7J20IOyeiOuKlCDrjJPquIDsnYAg7IiY7KCVL+yCreygnO2VoCDsiJgg7JeG7Iq164uI64ukLg=="))))}
function urlfy(e,t){return e.replace(RegExp("(https?:\\/\\/"+t.join("\\/?[^\\s<\\\"']+)|(https?:\\/\\/")+"\\/?[^\\s<\\\"']+)","g"),function(e){return'<a href="'+e+'" target="'+(1==Comment_option.comment_urls_open?"_blank":"_self")+'">'+e+"</a>"})}function _getEntryCommentsByPaging(e){getEntryCommentsByPaging(e),comment_refresh()}function _deleteComment(e){var t="comment"+e,r="<b>수정 / 삭제된 댓글입니다. 새로고침(F5) 해주세요</b>";if(null==tistory_hi098123_comment[t])tistory_hi098123_comment[rps_finder[t]].rps[t].comm=r;else{tistory_hi098123_comment[t].comm=r;for(var n=tistory_hi098123_comment[t].rps,_=0;_<n.length;_++)n[n[_]].comm=r}deleteComment(e)}function comment_refresh(){if(""!=comment_history.node&&""!=comment_history.code)var e=100,t=100,r=!0,n=setInterval(function(){--e<1&&clearInterval(n);var _=document.querySelectorAll(comment_history.node+" script");if(_.length>0){clearInterval(n);for(var o=[],i=0;i<_.length-1;i++){var m=document.createElement("script");m.innerHTML=_[i].innerHTML+"comment_refresh_num="+i+";",document.body.appendChild(m),o.push(m)}var c=setInterval(function(){if(t--,comment_refresh_num==_.length-2||t<1)if(clearInterval(c),r&&(r=!1,tistory_hi098123_comment.sort(function(e,t){return e>t?1:e<t?-1:0})),null==tistory_hi098123_comment[tistory_hi098123_comment[tistory_hi098123_comment.length-1]].name)comment_refresh();else try{hi098123_comment(comment_history.node,comment_history.code);for(var e=0;e<o.length;e++)document.body.removeChild(o[e])}catch(e){}},100)}},300)}function imgLoad_hi098123(e,t,r){for(var n=e.split("[img:"),_=0==t.length&&0==r.length,o=0;o<n.length;o++){var i=n[o].split("]",1)[0];if(_)e=e.split("[img:"+i+"]").join('<img src="'+i+'" style="max-width:100%;">');else if(0==t.length){var m=i.split("/")[2];-1==r.indexOf(m)&&(e=e.split("[img:"+i+"]").join('<img src="'+i+'" style="max-width:100%;">'))}else if(0==r.length){m=i.split("/")[2];t.indexOf(m)>-1&&(e=e.split("[img:"+i+"]").join('<img src="'+i+'" style="max-width:100%;">'))}else{m=i.split("/")[2];if(r.indexOf(m)>-1)continue;t.indexOf(m)>-1&&(e=e.split("[img:"+i+"]").join('<img src="'+i+'" style="max-width:100%;">'))}}return e}setInterval(function(){if(""!=openWindow)try{openWindow.onbeforeunload=function(e){comment_refresh()}}catch(e){}},300);